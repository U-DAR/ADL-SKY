<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ADL SKY</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <!-- Snap Pixel Code -->
  <script type="text/javascript">
    (function(e,t,n){if(e.snaptr)return;var a=e.snaptr=function()
    {a.handleRequest?a.handleRequest.apply(a,arguments):a.queue.push(arguments)};
    a.queue=[];var s='script',r=t.createElement(s);r.async=!0;
    r.src=n;var u=t.getElementsByTagName(s)[0];
    u.parentNode.insertBefore(r,u);})(window,document,'https://sc-static.net/scevent.min.js');
    snaptr('init', 'a2f0ee05-5e6d-4cd0-8c9a-616d41cba85f', {}); /* Snap Pixel ID (keep or change) */
    snaptr('track', 'PAGE_VIEW');
  </script>
  <!-- End Snap Pixel Code -->

  <style>
    :root{--brand:#003366;}
    *{box-sizing:border-box}
    body, html{
      margin:0; padding:0; height:100%;
      font-family:'Poppins',sans-serif;
      display:flex; justify-content:center; align-items:center;
      overflow:hidden; background:#f7f7f7;
    }
    .video-bg{
      position:fixed; inset:0; width:100%; height:100%;
      object-fit:cover; z-index:-1; filter:brightness(65%) contrast(110%);
    }
    .overlay{
      position:absolute; inset:0; display:flex; justify-content:center; align-items:center; padding:20px;
      background:linear-gradient(to bottom, rgba(0,0,0,.35), rgba(0,0,0,.65));
    }
    @keyframes fadeSlideUp{from{opacity:0;transform:translateY(40px)}to{opacity:1;transform:translateY(0)}}
    @keyframes fadeZoomIn{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}
    @keyframes logoFadeIn{from{opacity:0;transform:scale(.85)}to{opacity:1;transform:scale(1)}}

    .form-container{
      width:100%; max-width:320px;
      background:rgba(255,255,255,.2); backdrop-filter:blur(10px);
      border:1px solid rgba(255,255,255,.2);
      border-radius:16px; padding:16px;
      box-shadow:0 10px 24px rgba(0,0,0,.28);
      color:#fff; animation:fadeSlideUp .9s ease forwards;
    }
    .logos{display:flex; justify-content:center; gap:18px; margin-bottom:10px}
    .logos img{width:80px; height:auto; opacity:0; animation:logoFadeIn .8s ease forwards}
    .logos img:nth-child(1){animation-delay:.4s}
    .logos img:nth-child(2){animation-delay:.7s}
    h2{margin:6px 0; font-size:18px; text-align:center}
    p.subheading{margin:2px 0 10px; font-size:12px; color:#e0e0e0; text-align:center}
    form{display:flex; flex-direction:column; gap:8px}
    input, button{
      width:100%; padding:10px 12px; font-size:14px; border-radius:8px; border:1px solid #e5e7eb;
    }
    input{background:#fff; color:#111; text-align:right}
    input:focus{outline:2px solid #bcd0ff; border-color:#bcd0ff}
    button{
      border:none; background:var(--brand); color:#fff; font-weight:700; cursor:pointer;
      animation:fadeZoomIn .8s ease .8s both;
    }
    button:hover{filter:brightness(.92)}
    .hint{font-size:11px; color:#dfe7ff; text-align:center}
    .success-message,.error-message{display:none; margin-top:8px; font-size:14px; text-align:center}
    .success-message{color:#00ff99}
    .error-message{color:#ffb3b3}
    @media(max-width:600px){
      .form-container{max-width:280px; padding:14px}
      .logos img{width:70px}
    }
  </style>
</head>
<body>

  <!-- خلفية الفيديو (EDIT HERE: غيّري المسارات فقط) -->
  <video class="video-bg" autoplay muted loop playsinline webkit-playsinline>
    <source src="your-video.mp4" type="video/mp4">     <!-- (EDIT HERE) -->
    <source src="your-video.webm" type="video/webm">   <!-- (EDIT HERE) -->
    <source src="your-video.ogv" type="video/ogg">     <!-- (EDIT HERE) -->
    متصفحك لا يدعم تشغيل الفيديو.
  </video>

  <div class="overlay">
    <div class="form-container">
      <div class="logos">
        <img src="images/logo1.png" alt="Logo 1"> <!-- (EDIT HERE) -->
        <img src="images/logo2.png" alt="Logo 2"> <!-- (EDIT HERE) -->
      </div>

      <h2>حياة تلامس السماء</h2>
      <p class="subheading">برج سكني بموقع مميز وتصميم راقٍ بمواصفات استثنائية</p>
      <h2>سجل اهتمامك</h2>

      <!-- نموذج الاهتمام -->
      <form id="interestForm" action="https://formspree.io/f/xgvzzebo" method="POST"> <!-- Formspree (يمكن تغييره) -->
        <input type="text" name="name" id="name" placeholder="الاسم الكامل" required>
        <input type="tel" name="phone" id="phone" placeholder="رقم الهاتف" required>

        <!-- تتبع المصدر الأساسي الذي عندك -->
        <input type="hidden" name="source" id="source">
        <input type="hidden" name="utm_source" id="utm_source">
        <input type="hidden" name="page_url" id="page_url">
        <input type="hidden" name="referrer" id="referrer">

        <!-- حقول تتبّع إضافية + سياق -->
        <input type="hidden" name="utm_medium" id="utm_medium">
        <input type="hidden" name="utm_campaign" id="utm_campaign">
        <input type="hidden" name="utm_term" id="utm_term">
        <input type="hidden" name="utm_content" id="utm_content">
        <input type="hidden" name="gclid" id="gclid">
        <input type="hidden" name="fbclid" id="fbclid">
        <input type="hidden" name="timestamp" id="timestamp">

        <!-- إيميل (مخفي افتراضياً — اظهريه لو تبين) -->
        <input type="hidden" name="email" id="email">

        <!-- honeypot لمنع البوتات -->
        <input type="text" name="website" id="honeypot" autocomplete="off" style="display:none">

        <!-- خيارات Formspree إضافية (اختياري) -->
        <!-- <input type="hidden" name="_redirect" value="https://example.com/thanks"> (EDIT HERE if needed) -->

        <button id="submitBtn" type="submit">إرسال</button>
        <div class="hint">بالضغط على إرسال، أنت توافق على سياسة الخصوصية.</div>
      </form>

      <!-- رسائل الحالة -->
      <div class="success-message" id="successMessage">✅ تم استلام طلبك من <span id="platformName"></span></div>
      <div class="error-message" id="errorMessage">❌ حدث خطأ، حاول مرة أخرى.</div>

      <ul class="features" style="list-style:none; padding:0; margin-top:10px; font-size:12px; line-height:1.6; text-align:right; color:#fff">
        <li>✔ واجهات زجاجية بالكامل</li>
        <li>✔ مدخل فخم بتصميم فندقي</li>
        <li>✔ شقق نصف مؤثثة</li>
        <li>✔ وحدات تناسب السكن والاستثمار</li>
      </ul>
    </div>
  </div>

  <script>
    // ===== أدوات مساعدة =====
    const qs = new URLSearchParams(location.search);
    const getQS = (k, def="") => (qs.get(k) || def).trim();
    const byId = id => document.getElementById(id);

    // عناصر الواجهة
    const form = byId("interestForm");
    const btn = byId("submitBtn");
    const okMsg = byId("successMessage");
    const errMsg = byId("errorMessage");
    const platformSpan = byId("platformName");

    // منع الإرسال المتكرر في نفس الجلسة
    const SUBMIT_FLAG = "lead_autosubmitted";
    const hasSubmitted = () => sessionStorage.getItem(SUBMIT_FLAG) === "1";
    const markSubmitted = () => sessionStorage.setItem(SUBMIT_FLAG, "1");

    // اسم المنصة للعرض
    function resolvePlatformLabel(src){
      const map = {
        snap:"سناب", snapchat:"سناب",
        tiktok:"تيك توك",
        instagram:"إنستغرام", ig:"إنستغرام",
        x:"إكس", twitter:"إكس",
        facebook:"فيسبوك",
        unknown:"مصدر غير معروف"
      };
      return map[src] || src;
    }

    document.addEventListener("DOMContentLoaded", () => {
      // 1) تعبئة حقول التتبّع
      const rawSource  = getQS("source");
      const utm_source = getQS("utm_source");
      const resolvedSource = (rawSource || utm_source || "unknown").toLowerCase();

      byId("source").value     = resolvedSource;
      byId("utm_source").value = utm_source;
      byId("page_url").value   = location.href;
      byId("referrer").value   = document.referrer || "";

      ["utm_medium","utm_campaign","utm_term","utm_content","gclid","fbclid"].forEach(k=>{
        const el = byId(k);
        if (el) el.value = getQS(k);
      });
      byId("timestamp").value = new Date().toISOString();

      // 2) تعبئة بيانات العميل من الرابط (إن وجدت)
      const nameInput  = byId("name");
      const phoneInput = byId("phone");
      const emailInput = byId("email"); // مخفي افتراضياً

      const qsName  = getQS("name");
      const qsPhone = getQS("phone");
      const qsEmail = getQS("email");

      if (qsName)  nameInput.value  = qsName;
      if (qsPhone) phoneInput.value = qsPhone;
      if (qsEmail) emailInput.value = qsEmail;

      // 3) تحسين نصّ المنصة
      platformSpan.textContent = resolvePlatformLabel(resolvedSource);

      // 4) الإرسال التلقائي (إذا توفّر جوال أو إيميل) ولم يُرسل في هذه الجلسة
      const haveMinimum = (phoneInput.value.trim() || emailInput.value.trim());
      if (!hasSubmitted() && haveMinimum) {
        setTimeout(() => autoSubmit(), 300); // مهلة قصيرة
      }
    });

    async function autoSubmit(){
      okMsg.style.display = "none";
      errMsg.style.display = "none";
      btn.disabled = true;

      // honeypot: إيقاف إذا مُلئ
      const hp = byId("honeypot");
      if (hp && hp.value){ btn.disabled=false; return; }

      try{
        // إذا ودك ترسلي بنفس formspree بدون AJAX احذفي هذا القسم وخلي submit عادي
        const data = new FormData(form);
        const endpoint = form.getAttribute("action"); // https://formspree.io/f/xgvzzebo

        const resp = await fetch(endpoint, {
          method:"POST",
          body:data,
          headers:{ "Accept":"application/json" }
        });

        if (resp.ok){
          // تتبّع تحويل سناب بعد نجاح الإرسال
          if (typeof snaptr === "function"){
            try { snaptr('track','SIGN_UP',{ source: byId("source").value }); } catch {}
          }

          markSubmitted();
          okMsg.style.display = "block";
          form.reset();

          // إعادة تعبئة حقول التتبع بعد reset
          const keep = {
            source: byId("source").value,
            utm_source: byId("utm_source").value,
            page_url: location.href,
            referrer: document.referrer || "",
            utm_medium: byId("utm_medium")?.value || "",
            utm_campaign: byId("utm_campaign")?.value || "",
            utm_term: byId("utm_term")?.value || "",
            utm_content: byId("utm_content")?.value || "",
            gclid: byId("gclid")?.value || "",
            fbclid: byId("fbclid")?.value || "",
            timestamp: new Date().toISOString(),
            email: "" // لا نُعيد عرض الإيميل بعد الإرسال
          };
          Object.entries(keep).forEach(([k,v])=>{
            const el = byId(k); if (el) el.value = v;
          });

        }else{
          errMsg.style.display = "block";
        }

      }catch(e){
        errMsg.style.display = "block";
      }finally{
        btn.disabled = false;
      }
    }

    // زر الإرسال التقليدي (كباك أب)
    form.addEventListener("submit", (e)=>{
      e.preventDefault();
      autoSubmit();
    });
  </script>
</body>
</html>
